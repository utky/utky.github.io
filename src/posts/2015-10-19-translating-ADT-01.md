------------------
title: 代数的データ型へと翻訳する#01
date: 2015-10-19
tags: [haskell, functional programming]
------------------

はじめに
=====

Haskellはその豊かな型システムを用いることで強力な表現力を獲得しています。
でもその表現力を使いこなすためは、私たちもいくばくかのスキルをつけなければなりません。

その中でもいま私が一番重要だと考えているのが、

*問題を代数的データ型で表現するスキル*

です。

このスキルが不十分だとデータ型を関数上で扱うときに不必要なboiler plateが多発したり、
必要な拡張ができなくなったり、最悪解決したい問題すら解決できません。


*Haskellにおいてはデータ型の設計は生命線なのです。*


この記事ではいま私自身が直面している問題領域を代数的データ型へと
翻訳していく過程を記します。

そしてその途中では練習と称してよく見かける問題も代数的データ型へと翻訳してみようと思います。

翻訳という考え方は最近読んでいる新井紀子さんの名著『[数学は言葉](http://www.amazon.co.jp/dp/4489020538)』からインスパイアされました。
言葉で表された問題を分析して数式に翻訳していく営みが美しいと感じました。
同じことがHaskellのADT（代数的データ型）でもできるのではないかと思っています。

問題をよりよいデータ型で表現したいです。
ただそれだけです。

問題の発見
==========

Sqliteのデータベースへデータ登録を行ったり、
ファイルシステムとのIOを行ったりするようなCLIをもつアプリケーションを作っています。

[lycopene](https://github.com/utky/lycopene)

サーバプロセスなどを立ち上げずに軽くBacklogの管理をしたいな、と思ったのがきっかけで作り始めました。
しかしDBとのIOの絡んだテストコードでは、思うように結果セットからデータを引き出せないなど
数々の問題に直面することになりました。

その時の問題の切り分けのしにくさに我がコードながら辟易し始めました。

よかれと思って書いた自分のコードのデータ設計は本当に正しいのだろうか？

一時期調子に乗ってFreeモナドを導入したあたりで何かシンプルで良いものが失われた気がしました。


問題領域をよく表現した見通しのよいデータ型で再設計をし、
スマートに目的を達成するのが実は一番近道なのだと思うようになりました。

見通しのよいデータ型を設計するためにも、
関心を持った問題領域を代数的データ型（ADT）へと翻訳していくのが良さそうだとあたりをつけました。

ここからは言葉とADTの変換を中心に書いていこうと思います。
